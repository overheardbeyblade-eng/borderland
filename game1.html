<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>[ROUND ROBIN] 難易度</title>
<style>
  body {
    font-family: "Noto Sans JP", sans-serif;
    text-align: center;
    background: #fff;
    color: #000;
    padding-top: 80px;
  }
  h1 { font-weight: 600; font-size: 1.4rem; letter-spacing: 1px; margin-bottom: 4px; }
  p { font-size: 1.2rem; margin: 0 0 40px 0; }

  .card-container {
    display:flex;
    flex-direction:column;
    justify-content:center;
    align-items:center;
    height:280px;
  }

  img {
    width:160px;
    border-radius:10px;
    box-shadow:0 2px 10px rgba(0,0,0,0.2);
    transition: opacity 0.12s ease-in-out, transform 0.12s ease;
    display:block;
  }

  #cardName { margin-top:12px; font-size:1.1rem; font-weight:500; letter-spacing:0.5px; min-height:24px; }
  #cardInfo {
    margin-top:30px;
    font-size:1rem;
    color:#333;
    border-top:1px solid #ccc;
    padding-top:15px;
    max-width:320px;
    margin-left:auto;
    margin-right:auto;
    line-height:1.6;
    min-height:48px;
  }

  button {
    margin-top:16px;
    background:#000;
    color:#fff;
    border:none;
    padding:12px 28px;
    border-radius:6px;
    font-size:1rem;
    cursor:pointer;
  }
  button:hover { background:#444; }

  .highlight { font-weight:600; }
  @media (max-width:420px){ img{width:140px;} }
</style>
</head>
<body>

<h1>[GAME 1]</h1>
<p>難易度</p>

<div class="card-container">
  <img id="cardImage" src="https://deckofcardsapi.com/static/img/AS.png" alt="Kartu">
  <div id="cardName">Ace of Spades</div>
</div>

<button id="shuffleButton">Shuffle</button>
<button onclick="window.location.href='index.html'">Home</button>

<div id="cardInfo">
  <div><span class="highlight">Format:</span> 1G</div>
  <div><span class="highlight">Effect:</span> Swap your opponent’s Bit Combo.</div>
</div>

<script>
/* Config */
const shuffleIntervalMs = 100;
const shuffleDuration = 1400;

/* Cards (suit: Clubs=C, Diamonds=D, Hearts=H, Spades=S)
   Base URL: https://deckofcardsapi.com/static/img/{code}.png */
const allCards = [
  { url: "https://deckofcardsapi.com/static/img/3C.png", name: "3 of Clubs" },
  { url: "https://deckofcardsapi.com/static/img/3D.png", name: "3 of Diamonds" },
  { url: "https://deckofcardsapi.com/static/img/3H.png", name: "3 of Hearts" },
  { url: "https://deckofcardsapi.com/static/img/3S.png", name: "3 of Spades" },
  { url: "https://deckofcardsapi.com/static/img/4C.png", name: "4 of Clubs" },
  { url: "https://deckofcardsapi.com/static/img/4D.png", name: "4 of Diamonds" },
  { url: "https://deckofcardsapi.com/static/img/4H.png", name: "4 of Hearts" },
  { url: "https://deckofcardsapi.com/static/img/4S.png", name: "4 of Spades" },
  { url: "https://deckofcardsapi.com/static/img/5C.png", name: "5 of Clubs" },
  { url: "https://deckofcardsapi.com/static/img/5D.png", name: "5 of Diamonds" },
  { url: "https://deckofcardsapi.com/static/img/5H.png", name: "5 of Hearts" },
  { url: "https://deckofcardsapi.com/static/img/5S.png", name: "5 of Spades" },
  { url: "https://deckofcardsapi.com/static/img/AC.png", name: "Ace of Clubs" },
  { url: "https://deckofcardsapi.com/static/img/AD.png", name: "Ace of Diamonds" },
  { url: "https://deckofcardsapi.com/static/img/AH.png", name: "Ace of Hearts" },
  { url: "https://deckofcardsapi.com/static/img/AS.png", name: "Ace of Spades" }
];

/* State of remaining deck */
let remainingDeck = [...allCards];

/* Rules mapping (from rulebook) */
function getFormat(value) {
  if (value.includes("Ace")) return "1G";
  if (value.includes("3")) return "3G";
  if (value.includes("4")) return "4G";
  if (value.includes("5")) return "5G";
  return "-";
}
function getEffect(value) {
  if (value.includes("Hearts")) return "Exchange 1 Beyblade with your opponent.";
  if (value.includes("Diamonds")) return "Both players use Lock Deck format.";
  if (value.includes("Spades")) return "Swap your opponent’s Bit Combo.";
  if (value.includes("Clubs")) return "Blind choose opponent’s Bey order.";
  return "-";
}

/* DOM */
const cardImage = document.getElementById("cardImage");
const cardName  = document.getElementById("cardName");
const cardInfo  = document.getElementById("cardInfo");
const shuffleButton = document.getElementById("shuffleButton");

/* internal state */
let shuffleInterval = null;
let pendingSwapTimeout = null;
let selectedCard = null;

function setCardVisual(card){
  cardImage.style.opacity = 0;
  cardName.style.opacity = 0;
  if (pendingSwapTimeout) { clearTimeout(pendingSwapTimeout); pendingSwapTimeout = null; }
  pendingSwapTimeout = setTimeout(() => {
    cardImage.src = card.url;
    cardName.textContent = card.name;
    cardImage.style.opacity = 1;
    cardName.style.opacity = 1;
    pendingSwapTimeout = null;
  }, 60);
}

function drawUniqueCard(){
  if (remainingDeck.length === 0) {
    remainingDeck = [...allCards];
  }
  const idx = Math.floor(Math.random() * remainingDeck.length);
  const card = remainingDeck.splice(idx, 1)[0];
  return card;
}

/* Shuffle handler */
shuffleButton.addEventListener("click", () => {
  shuffleButton.disabled = true;
  cardInfo.innerHTML = "";

  if (shuffleInterval) { clearInterval(shuffleInterval); shuffleInterval = null; }
  if (pendingSwapTimeout) { clearTimeout(pendingSwapTimeout); pendingSwapTimeout = null; }

  shuffleInterval = setInterval(() => {
    const r = allCards[Math.floor(Math.random() * allCards.length)];
    if (pendingSwapTimeout) { clearTimeout(pendingSwapTimeout); pendingSwapTimeout = null; }
    pendingSwapTimeout = setTimeout(() => {
      cardImage.src = r.url;
      cardName.textContent = r.name;
      cardImage.style.opacity = 1;
      cardName.style.opacity = 1;
      pendingSwapTimeout = null;
    }, 60);
  }, shuffleIntervalMs);

  setTimeout(() => {
    if (shuffleInterval) { clearInterval(shuffleInterval); shuffleInterval = null; }
    if (pendingSwapTimeout) { clearTimeout(pendingSwapTimeout); pendingSwapTimeout = null; }

    selectedCard = drawUniqueCard();
    setCardVisual(selectedCard);

    const format = getFormat(selectedCard.name);
    const effect = getEffect(selectedCard.name);

    setTimeout(() => {
      cardInfo.innerHTML = `
        <div><span class="highlight">Format:</span> ${format}</div>
        <div><span class="highlight">Effect:</span> ${effect}</div>
      `;
      shuffleButton.disabled = false;
    }, 120);
  }, shuffleDuration);
});
</script>

</body>
</html>

